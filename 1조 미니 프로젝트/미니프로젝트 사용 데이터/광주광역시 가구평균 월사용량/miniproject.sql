CREATE TABLE weather2021 (
	 region_id INT,
    region_name VARCHAR(255),
    month DATE PRIMARY KEY,
    avg_temp DECIMAL(5, 1), 
    avg_max_temp DECIMAL(5, 1), 
    max_temp DECIMAL(5, 1),  
    max_temp_date DATE,
    avg_min_temp DECIMAL(5, 1),
    min_temp DECIMAL(5, 1),
    min_temp_date DATE
);

INSERT INTO weather2021(region_id, region_name, month, avg_temp, avg_max_temp, max_temp, max_temp_date, avg_min_temp, min_temp, min_temp_date)
VALUES
	 (156, '광주', '2021-01-01', 1.4, 6.4, 15.5, '2021-01-25', -2.6, -13.5, '2021-01-08'),
    (156, '광주', '2021-02-01', 5.1, 10.7, 22.6, '2021-02-21', 0.4, -5.8, '2021-02-17'),
    (156, '광주', '2021-03-01', 10.6, 17.0, 25.0, '2021-03-26', 5.6, -0.1, '2021-03-03'),
    (156, '광주', '2021-04-01', 14.9, 20.9, 27.2, '2021-04-24', 9.7, 3.6, '2021-04-15'),
    (156, '광주', '2021-05-01', 18.4, 24.0, 30.4, '2021-05-23', 13.4, 7.1, '2021-05-06'),
    (156, '광주', '2021-06-01', 23.3, 28.3, 32.8, '2021-06-21', 19.2, 14.9, '2021-06-05'),
    (156, '광주', '2021-07-01', 27.0, 31.4, 35.1, '2021-07-21', 23.6, 20.1, '2021-07-05'),
    (156, '광주', '2021-08-01', 25.8, 30.3, 34.5, '2021-08-06', 22.5, 19.9, '2021-08-20'),
    (156, '광주', '2021-09-01', 22.9, 27.2, 32.4, '2021-09-30', 19.5, 15.8, '2021-09-24'),
    (156, '광주', '2021-10-01', 17.2, 22.7, 30.7, '2021-10-10', 12.8, 3.6, '2021-10-18'),
    (156, '광주', '2021-11-01', 10.2, 15.8, 23.8, '2021-11-07', 5.8, 1.1, '2021-11-28'),
    (156, '광주', '2021-12-01', 4.1, 9.4, 15.4, '2021-12-10', 0.0, -8.3, '2021-12-26');
    

CREATE TABLE weather2022 (
	 region_id INT,
    region_name VARCHAR(255),
    month DATE PRIMARY KEY,
    avg_temp DECIMAL(5, 1), 
    avg_max_temp DECIMAL(5, 1), 
    max_temp DECIMAL(5, 1),  
    max_temp_date DATE,
    avg_min_temp DECIMAL(5, 1),
    min_temp DECIMAL(5, 1),
    min_temp_date DATE
);


INSERT INTO weather2022(region_id, region_name, month, avg_temp, avg_max_temp, max_temp, max_temp_date, avg_min_temp, min_temp, min_temp_date)
VALUES
    (156, '광주', '2022-01-01', 1.6, 6.7, 12.2, '2022-01-22', -2.3, -6.4, '2022-01-20'),
    (156, '광주', '2022-02-01', 1.8, 7.2, 16.5, '2022-02-28', -2.4, -7.8, '2022-02-17'),
    (156, '광주', '2022-03-01', 9.6, 15.6, 22.8, '2022-03-12', 4.5, -0.9, '2022-03-07'),
    (156, '광주', '2022-04-01', 15.5, 22.6, 29.2, '2022-04-12', 9.8, 2.1, '2022-04-03'),
    (156, '광주', '2022-05-01', 19.3, 26.1, 31.9, '2022-05-24', 13.8, 6.9, '2022-05-03'),
    (156, '광주', '2022-06-01', 23.8, 29.0, 34.1, '2022-06-03', 20.1, 15.8, '2022-06-08'),
    (156, '광주', '2022-07-01', 27.0, 31.1, 34.8, '2022-07-02', 23.8, 20.2, '2022-07-18'),
    (156, '광주', '2022-08-01', 26.9, 30.6, 34.2, '2022-08-07', 24.1, 17.2, '2022-08-28'),
    (156, '광주', '2022-09-01', 23.1, 28.0, 34.5, '2022-09-18', 19.1, 13.9, '2022-09-22'),
    (156, '광주', '2022-10-01', 16.0, 21.6, 30.5, '2022-10-01', 11.4, 4.7, '2022-10-25'),
    (156, '광주', '2022-11-01', 11.8, 18.1, 24.4, '2022-11-11', 6.8, -1.7, '2022-11-30'),
    (156, '광주', '2022-12-01', 1.1, 5.5, 12.7, '2022-12-08', -2.6, -8.0, '2022-12-25');


SELECT * FROM weather2021;
SELECT * FROM weather2022;

SELECT
    EXTRACT(MONTH FROM w1.month) AS '월',
    w1.avg_temp AS '2021년 평균 온도',
    w2.avg_temp AS '2022년 평균 온도',
    w1.avg_temp - w2.avg_temp AS '평균 온도차이'
FROM
    weather2021 AS w1
JOIN
    weather2022 AS w2
ON
    EXTRACT(MONTH FROM w1.month) = EXTRACT(MONTH FROM w2.month);

CREATE TABLE elec2021(
month DATE PRIMARY KEY,
customers INT NOT NULL,
max_demand FLOAT NOT NULL,
use_amount FLOAT NOT NULL);
  
INSERT INTO elec2021(month,customers,max_demand,use_amount) VALUES 
('2021-01-01',553047,89329,11875),
('2021-02-01',553578,50989,11016),
('2021-03-01',558196,57299,11082),
('2021-04-01',554413,57890,21547),
('2021-05-01',554681,45014,9685),
('2021-06-01',555151,78967,12388),
('2021-07-01',555639,78537,13124),
('2021-08-01',555904,57019,12385),
('2021-09-01',556482,64294,12901),
('2021-10-01',556770,74478,13793),
('2021-11-01',561971,73303,14679),
('2021-12-01',558106,73381,14683);

CREATE TABLE elec2022(
month DATE PRIMARY KEY,
customers INT NOT NULL,
max_demand FLOAT NOT NULL,
use_amount FLOAT NOT NULL);




INSERT INTO elec2022(month,customers,max_demand,use_amount) VALUES
('2022-01-01',558709,68395,15301),
('2022-02-01',559062,165266,18331),
('2022-03-01',563898,182049,22655),
('2022-04-01',560298,115552,18514),
('2022-05-01',560729,80219,15542),
('2022-06-01',561143,95529,16505),
('2022-07-01',561729,100928,17931),
('2022-08-01',562109,86061,14982),
('2022-09-01',562725,78318,14954),
('2022-10-01',563454,81368,14111),
('2022-11-01',568369,81006,12864),
('2022-12-01',564128,51985,11278);



CREATE TABLE SALE2021(
   month DATE PRIMARY KEY ,
	sales_amount INT NOT NULL,
	customers INT NOT NULL,
	income INT NOT NULL
	);
	
INSERT INTO SALE2021 (month, sales_amount, customers, income)
VALUES 
	('2021-01-01', 811864, 553047, 95996),
	('2021-02-01', 767277, 553578, 91604),
	('2021-03-01', 697761, 558196, 74931),
	('2021-04-01', 696052, 554413, 71239),
	('2021-05-01', 695751, 554681, 67591),
	('2021-06-01', 713735, 555151, 83433),
	('2021-07-01', 790946, 555639, 97643),
	('2021-08-01', 876521, 555904, 108975),
	('2021-09-01', 781758, 556482, 86010),
	('2021-10-01', 705604, 556770, 73618),
	('2021-11-01', 710814, 561971, 83231),
	('2021-12-01', 761414, 558106, 93034);

CREATE TABLE SALE2022(
   month DATE PRIMARY KEY ,
	sales_amount INT NOT NULL,
	customers INT NOT NULL,
	income INT NOT NULL
	);
INSERT INTO SALE2022 (month, sales_amount, customers, income)
VALUES 
	('2022-01-01', 825883, 558709, 99993),
	('2022-02-01', 788537, 559062, 96379),
	('2022-03-01', 735401, 563898, 81279),
	('2022-04-01', 712892, 560298, 78285),
	('2022-05-01', 672419, 560729, 75663),
	('2022-06-01', 717565, 561143, 90088),
	('2022-07-01', 838799, 561729, 116442),
	('2022-08-01', 892015, 562109, 123460),
	('2022-09-01', 806888, 562725, 101485),
	('2022-10-01', 691579, 563454, 85947),
	('2022-11-01', 690525, 568369, 96580),
	('2022-12-01', 744368, 564128, 107671);

# 광주의 2021년과 2022년 온도 변화에 따른 전기 사용량 차이를 보여주는 데이터 이관 스크립트
SELECT
    EXTRACT(MONTH FROM e1.month) AS '월',
    e1.use_amount AS '2021년 전기 사용량',
    e2.use_amount AS '2022년 전기 사용량',
    e2.use_amount - e1.use_amount AS '전기 사용량 차이',
    w1.avg_temp AS '2021년 평균 온도',
    w2.avg_temp AS '2022년 평균 온도',
    w2.avg_temp - w1.avg_temp AS '평균 온도차이'
FROM
    elec2021 AS e1
JOIN
    elec2022 AS e2
ON
    EXTRACT(MONTH FROM e1.month) = EXTRACT(MONTH FROM e2.month)
JOIN
    weather2021 AS w1
ON
    EXTRACT(MONTH FROM e1.month) = EXTRACT(MONTH FROM w1.month)
JOIN
    weather2022 AS w2
ON
    EXTRACT(MONTH FROM e2.month) = EXTRACT(MONTH FROM w2.month);


   
CREATE TABLE seoul_2122_category_sale(
month DATE PRIMARY KEY,
house_amount INT NOT NULL,
general FLOAT NOT NULL,
education FLOAT NOT NULL,
industry FLOAT NOT NULL,
farming FLOAT NOT NULL,
streetlamp FLOAT NOT NULL,
midnight FLOAT NOT NULL,
sum FLOAT NOT NULL);

INSERT INTO seoul_2122_category_sale 
(month,house_amount,general,education,industry,farming,streetlamp,midnight,sum) VALUES 
('2021-01-01',1331688,2371896,193016,448732,2068,28186,24824,4400410),
('2021-02-01',1272211,2212642,173794,423733,2027,26183,23456,4134045),
('2021-03-01',1090282,1886032,142624,387109,1845,23847,19012,3550751),
('2021-04-01',1112408,1781886,120965,390399,1692,22898,19009,3449257),
('2021-05-01',1060023,1731810,103542,379296,1546,21116,27429,3324763),
('2021-06-01',1127819,1983261,120395,398126,1568,19773,50679,3701621),
('2021-07-01',1391210,2339594,143021,438177,1726,19432,73393,4406553),
('2021-08-01',1844125,2556403,135899,473615,1959,20626,71239,5103868),
('2021-09-01',1336306,2172661,132751,427580,1859,21744,52183,4145083),
('2021-10-01',1131113,1893516,113695,386361,1620,23298,29112,3578614),
('2021-11-01',1126419,1843687,130558,394692,1799,25032,14955,3537141),
('2021-12-01',1175771,2146322,179081,416504,1916,25919,18186,3963700),
('2022-01-01',1303988,2500834,206767,454360,2386,26845,22836,4518017),
('2022-02-01',1283979,2370564,188853,433826,2410,25056,22686,4327374),
('2022-03-01',1137991,2069189,163318,398999,2100,22724,18682,3813003),
('2022-04-01',1123194,1891608,138000,388597,1739,21850,21990,3586979),
('2022-05-01',1065676,1876933,111789,376122,1597,20085,32081,3484283),
('2022-06-01',1110162,2099203,131203,397358,1607,18902,49436,3807870),
('2022-07-01',1432849,2497257,159968,448040,1708,18405,73865,4632092),
('2022-08-01',1696496,2662473,149534,468773,1866,19545,74908,5073596),
('2022-09-01',1352108,2294058,145728,426528,1706,20588,52470,4293187),
('2022-10-01',1111392,1942164,122005,384894,1537,22270,24063,3608325),
('2022-11-01',1105804,1876181,130057,384576,1774,24042,14666,3537100),
('2022-12-01',1182567,2275393,194418,409085,1835,25003,18550,4106851);

SELECT * FROM seoul_2122_category_sale;


CREATE TABLE gwangju_2122_category_sale(
month DATE PRIMARY KEY,
house_amount INT NOT NULL,
general FLOAT NOT NULL,
education FLOAT NOT NULL,
industry FLOAT NOT NULL,
farming FLOAT NOT NULL,
streetlamp FLOAT NOT NULL,
midnight FLOAT NOT NULL,
sum FLOAT NOT NULL);

INSERT INTO gwangju_2122_category_sale (month,house_amount,general,education,industry,farming,streetlamp,midnight,sum) VALUES 
('2021-01-01',200925,278465,32355,267717,11149,7885,13368,811864),
('2021-02-01',194943,262898,24793,254822,9635,7322,12813,767227),
('2021-03-01',168879,224108,23294,257754,7260,6618,9848,697761),
('2021-04-01',174584,218711,21738,261583,5523,6611,7301,696052),
('2021-05-01',165167,208632,18412,252521,4738,6058,4221,659751),
('2021-06-01',172341,234030,21371,271679,4904,5700,3709,713735),
('2021-07-01',194781,271010,26594,283956,5452,5534,3619,790946),
('2021-08-01',258513,308673,24240,268028,7654,5952,3461,876521),
('2021-09-01',209947,270063,25204,260905,6405,6166,3069,781758),
('2021-10-01',175802,236353,22003,256744,5138,6683,2882,705604),
('2021-11-01',175674,224022,22377,267177,8452,7268,5844,710814),
('2021-12-01',181094,248035,29869,277038,8272,7534,9572,761414),
('2022-01-01',197757,286008,32872,278239,11105,7771,12130,825883),
('2022-02-01',197989,278314,25763,256353,10710,7319,12089,788537),
('2022-03-01',175749,242966,26036,265681,8442,6521,10007,735401),
('2022-04-01',179953,229101,23873,259755,6547,6364,7299,712892),
('2022-05-01',164274,217010,18363,257892,5064,5844,3973,672419),
('2022-06-01',171201,245131,23294,263087,5868,5592,3393,717565),
('2022-07-01',215998,295199,29712,282528,6443,5393,3525,838799),
('2022-08-01',256460,317419,25994,274886,8112,5711,3432,892015),
('2022-09-01',221372,284746,26129,257991,7652,6118,2881,806888),
('2022-10-01',174970,234837,22139,244041,6371,6558,2664,691579),
('2022-11-01',172158,220521,21472,254434,9823,7081,5036,690525),
('2022-12-01',180573,251969,31160,256259,8624,7317,8466,744368);



SELECT SUM(house_amount) AS 가정용, SUM(industry) AS 공업용, SUM(GENERAL) AS 일반용
FROM gwangju_2122_category_sale;


SELECT SUM(GENERAL) AS 일반용
FROM gwangju_2122_category_sale
WHERE DATE_FORMAT(MONTH, '%Y') = '2021';

SELECT SUM(GENERAL) AS 일반용
FROM gwangju_2122_category_sale
WHERE DATE_FORMAT(MONTH, '%Y') = '2022';


CREATE TABLE gwangju21to22(
	MONTH DATE PRIMARY KEY,
	region_id int NOT null
);


INSERT INTO gwangju21to22(month, region_id) values
	('2021-01-01',156),
	('2021-02-01',156),
	('2021-03-01',156),
	('2021-04-01',156),
	('2021-05-01',156),
	('2021-06-01',156),
	('2021-07-01',156),
	('2021-08-01',156),
	('2021-09-01',156),
	('2021-10-01',156),
	('2021-11-01',156),
	('2021-12-01',156),
	('2022-01-01',156),
	('2022-02-01',156),
	('2022-03-01',156),
	('2022-04-01',156),
	('2022-05-01',156),
	('2022-06-01',156),
	('2022-07-01',156),
	('2022-08-01',156),
	('2022-09-01',156),
	('2022-10-01',156),
	('2022-11-01',156),
	('2022-12-01',156)



SELECT SUM(house_amount)
FROM gwangju_2122_category_sale
WHERE YEAR(MONTH) = 2021;


SELECT SUM(house_amount)
FROM gwangju_2122_category_sale
WHERE YEAR(MONTH) = 2022;

#일반용 가정용 10월부터 12월 비교(21년도가 더 큼)

SELECT house_amount+GENERAL+education AS '21년도 일반용 가정용 합'
FROM gwangju_2122_category_sale
WHERE DATE_FORMAT(MONTH, '%Y-%m-%d')
BETWEEN '2021-10-01' AND '2021-12-01';

SELECT house_amount+GENERAL+education AS '21년도 일반용 가정용 합'
FROM gwangju_2122_category_sale
WHERE DATE_FORMAT(MONTH, '%Y-%m-%d')
BETWEEN '2022-10-01' AND '2022-12-01';

SELECT '1월-2월 합계' AS '기간', SUM(house_amount+GENERAL+education) AS '21년도 일반용 가정용 합'
FROM gwangju_2122_category_sale
WHERE DATE_FORMAT(MONTH, '%Y-%m-%d') BETWEEN '2021-01-01' AND '2021-02-01'
UNION ALL
SELECT '11월-12월 합계' AS '기간', SUM(house_amount+GENERAL+education) AS '22년도 일반용 가정용 합'
FROM gwangju_2122_category_sale
WHERE DATE_FORMAT(MONTH, '%Y-%m-%d') BETWEEN '2021-11-01' AND '2021-12-01';


SELECT '1월-2월 합계' AS '기간', SUM(house_amount+GENERAL+education) AS '22년도 일반용 가정용 합'
FROM gwangju_2122_category_sale
WHERE DATE_FORMAT(MONTH, '%Y-%m-%d') BETWEEN '2022-01-01' AND '2022-02-01'
UNION ALL
SELECT '11월-12월 합계' AS '기간', SUM(house_amount+GENERAL+education) AS '22년도 일반용 가정용 합'
FROM gwangju_2122_category_sale
WHERE DATE_FORMAT(MONTH, '%Y-%m-%d') BETWEEN '2022-11-01' AND '2022-12-01';

SELECT AVG(avg_temp) AS '평균 온도' FROM weather2021
where DATE_FORMAT(MONTH, '%Y-%m-%d')
BETWEEN '2021-10-01' AND '2021-12-01'; 

SELECT AVG(avg_temp) AS '평균 온도' FROM weather2022
where DATE_FORMAT(MONTH, '%Y-%m-%d')
BETWEEN '2022-10-01' AND '2022-12-01'; 



SELECT * FROM gwangju_predict_use;

